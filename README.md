# Проект YaMDb  

![статус сборки](https://github.com/MikhailGolovin1982/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg?event=push)

## Проект YaMDb собирает отзывы (Review) пользователей на произведения (Titles).  

Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий (Category)  

может быть расширен администратором (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»). 

 

Вы можете выполнять основные задачи: 

 

Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.  

В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения  

«Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.  

Произведению может быть присвоен жанр (Genre) из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»).  

Новые жанры может создавать только администратор. Благодарные или возмущённые пользователи оставляют к произведениям  

текстовые отзывы (Review) и ставят произведению оценку в диапазоне от одного до десяти (целое число);  

из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число).  

На одно произведение пользователь может оставить только один отзыв.  

Примеры: Все примеры обращения описаны на http://51.250.30.86/redoc/  

Некоторые примеры запросов к API:  

- Получение публикаций  

- Получить список всех публикаций.  

- При указании параметров limit и offset выдача должна работать с пагинацией. 

 

## Технологии: 

- Python 

- Django 

- Django REST framework 

- PostgreSQL 

- NGINX 

- Docker 

 

## Как запустить проект (режим демонстрации - в Docker - контейнерах). 

 

Для простоты развертывания и демонтсрации, проект подготовлен для автоматического разворачивания в трех докер-контейнерах. 

- infra_nginx_1 

- infra_web_1 

- infra_db_1 

 

Последовательность разворачивания проекта. 

 

1) Клонировать репозиторий командой: 

 

```bash 

git clone git@github.com:MikhailGolovin1982/yamdb_final.git 

``` 

2) Если на вашем ПК не установлено прилоджение Docker Desktop - скачайте и установите его по ссылке 

 

    https://www.docker.com/products/docker-desktop/ 

 

   (должна быть настроена система виртуализации на вашем ПК, в вашей операционной системе) 

 

3) Перейдите в папку  

 

```bash 

cd yamdb_final/infra/ 

``` 

    

4) Выполните в терминале команду  

 

```bash 

docker-compose up 

``` 

 

В результате выполнения данной команды в вашем приложении Docker Desktop появиться три образа: 

- infra_web  

- nginx  

- postgres 

 

на основе которых запущены контейнеры: 

- infra_nginx_1 

- infra_web_1 

- infra_db_1 

 

также в работу будут включены три тома (Volumes): 

- infra_media_value 

- infra_static_value 

- ....latin lerrers and numbers..... 

 

5) Выполнить миграции командой: 

 

```bash 

docker-compose exec web python manage.py makemigrations
docker-compose exec web python manage.py migrate 

``` 

 

7) Создать суперпользователя 

 

```bash 

docker-compose exec web python manage.py createsuperuser 

``` 

 

8) Собрать статику: 

 

```bash     

docker-compose exec web python manage.py collectstatic --no-input 

``` 

 

9) Теперь проект доступен по адресу: 

 

     http://localhost/admin/  

 

     можно зайти по данной ссылке на сайт, создать необходимые записи, проверить работу API, например через PostMan 

 

10) Подробное описание API интрефейса приведено на страничке: 

 

   http://localhost/redoc/ 

 

   Например 

 

   Алгоритм регистрации пользователей  

- Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт  

 /api/v1/auth/signup/. 

- YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email. 

- Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/ в ответе на запрос ему приходит token (JWT-токен). 

- При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле (описание полей — в документации). 

 

11) Рекомендуется создать копию базы данных командой: 

 

```bash 

docker-compose exec web python manage.py dumpdata > fixtures.json 

``` 

 

## Описание переменных окружения 

### Переменные окружения содержатся в файле .env 

 

``` 

DB_ENGINE = <Тип базы данных - postgresql>  

 

DB_NAME = <имя базы данных> 

 

POSTGRES_USER = <логин для подключения к базе данных> 

 

POSTGRES_PASSWORD = <пароль для подключения к БД> 

 

DB_HOST = <название сервиса (контейнера)> 

 

DB_PORT = <порт для подключения к БД> 

 

SECRET_KEY = <секретный ключ> 

 

DEBUG = <состояние режима отладки> 

 

ALLOWED_HOSTS = <разрешенные хосты> 

``` 

 

Для переменной ALLOWED_HOSTS ожидается список разрешенных хостов с симолом ',' - в качестве разделителя 

 

### Авторы проекта:  

- Степан Калинин 

- Михаил Головин 

- Михаил Коновалов 